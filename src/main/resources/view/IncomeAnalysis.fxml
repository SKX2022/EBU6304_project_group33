<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.image.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.finance.controller.IncomeAnalysisController"
            stylesheets="@../css/style.css">

    <top>
        <fx:include source="NavigationBar.fxml" />
    </top>

    <center>
        <ScrollPane fitToWidth="true" style="-fx-background-color: #f8fafc;">
            <VBox spacing="30" style="-fx-padding: 30;">
                
                <!-- 页面标题 -->
                <HBox alignment="CENTER">
                    <VBox alignment="CENTER" spacing="10">
                        <Label text="💰 收入分析与税收计算" styleClass="income-title"/>
                        <Label text="输入您的年收入，我们将为您计算个人所得税和实际到手收入" styleClass="income-subtitle"/>
                    </VBox>
                </HBox>

                <!-- 主要内容区域 -->
                <HBox spacing="40" alignment="TOP_CENTER">
                    
                    <!-- 左侧：输入区域 -->
                    <VBox spacing="20" styleClass="income-input-card" minWidth="400">
                        <Label text="📊 收入信息输入" styleClass="section-title"/>
                        
                        <!-- 年收入输入 -->
                        <VBox spacing="8">
                            <Label text="年收入（税前）" styleClass="input-label"/>
                            <TextField fx:id="annualIncomeField" promptText="请输入年收入金额（元）" 
                                      styleClass="income-input-field" prefWidth="350"/>
                        </VBox>
                        
                        <!-- 工作城市选择 -->
                        <VBox spacing="8">
                            <Label text="工作城市" styleClass="input-label"/>
                            <ComboBox fx:id="cityComboBox" promptText="选择工作城市" 
                                     styleClass="income-input-field" prefWidth="350"/>
                        </VBox>
                        
                        <!-- 社保基数 -->
                        <VBox spacing="8">
                            <Label text="社保缴费基数" styleClass="input-label"/>
                            <TextField fx:id="socialSecurityBaseField" promptText="默认按工资计算，可手动调整" 
                                      styleClass="income-input-field" prefWidth="350"/>
                        </VBox>
                        
                        <!-- 公积金基数 -->
                        <VBox spacing="8">
                            <Label text="公积金缴费基数" styleClass="input-label"/>
                            <TextField fx:id="housingFundBaseField" promptText="默认按工资计算，可手动调整" 
                                      styleClass="income-input-field" prefWidth="350"/>
                        </VBox>
                        
                        <!-- 计算按钮 -->
                        <Button fx:id="calculateButton" text="🧮 计算税收" onAction="#calculateTax" 
                               styleClass="calculate-button" prefWidth="350"/>
                        
                        <!-- 重置按钮 -->
                        <Button fx:id="resetButton" text="🔄 重置" onAction="#resetForm" 
                               styleClass="reset-button" prefWidth="350"/>
                    </VBox>
                    
                    <!-- 右侧：结果显示区域 -->
                    <VBox spacing="20" styleClass="income-result-card" minWidth="450">
                        <Label text="📈 税收计算结果" styleClass="section-title"/>
                        
                        <!-- 收入汇总 -->
                        <VBox spacing="10" styleClass="result-summary">
                            <Label text="💼 收入汇总" styleClass="result-category"/>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="年收入（税前）：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="yearlyIncomeLabel" text="¥ 0.00" styleClass="result-value"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="月平均收入：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="monthlyIncomeLabel" text="¥ 0.00" styleClass="result-value"/>
                            </HBox>
                        </VBox>
                        
                        <!-- 扣除项目 -->
                        <VBox spacing="10" styleClass="result-summary">
                            <Label text="📋 扣除项目" styleClass="result-category"/>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="个人所得税：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="incomeTaxLabel" text="¥ 0.00" styleClass="tax-value"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="社保个人部分：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="socialSecurityLabel" text="¥ 0.00" styleClass="deduction-value"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="公积金个人部分：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="housingFundLabel" text="¥ 0.00" styleClass="deduction-value"/>
                            </HBox>
                            <Separator/>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="总扣除金额：" styleClass="result-label" style="-fx-font-weight: bold;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="totalDeductionLabel" text="¥ 0.00" styleClass="total-deduction-value"/>
                            </HBox>
                        </VBox>
                        
                        <!-- 实际收入 -->
                        <VBox spacing="10" styleClass="result-summary final-result">
                            <Label text="💰 实际到手" styleClass="result-category"/>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="年实际收入：" styleClass="result-label" style="-fx-font-weight: bold;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="netYearlyIncomeLabel" text="¥ 0.00" styleClass="net-income-value"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="月实际收入：" styleClass="result-label" style="-fx-font-weight: bold;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="netMonthlyIncomeLabel" text="¥ 0.00" styleClass="net-income-value"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT">
                                <Label text="税负率：" styleClass="result-label"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Label fx:id="taxRateLabel" text="0.00%" styleClass="result-value"/>
                            </HBox>
                        </VBox>
                        
                        <!-- 税收详情图表 -->
                        <VBox spacing="10">
                            <Label text="📊 税收构成分析" styleClass="result-category"/>
                            <PieChart fx:id="taxBredownChart" prefHeight="300" prefWidth="400" 
                                     legendSide="BOTTOM" labelsVisible="true"/>
                        </VBox>
                    </VBox>
                </HBox>
                
                <!-- 底部说明 -->
                <VBox spacing="10" styleClass="income-note-card">
                    <Label text="�� 计算说明" styleClass="note-title"/>
                    <Label text="• 个人所得税按照最新税率计算，包含专项扣除（起征点5000元）"/>
                    <Label text="• 社保费率：养老保险8%，医疗保险2%，失业保险0.5%"/>
                    <Label text="• 公积金费率：根据城市政策，一般为5%-12%"/>
                    <Label text="• 计算结果仅供参考，实际缴费可能因政策调整而有所差异"/>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>
